{"version":3,"file":"markdownItAST.mjs","sources":["../index.js"],"sourcesContent":["\n\nfunction markdownItAST(tokens) {\n  function genTreeNode(node) {\n    return {\n      nodeType: node && node.type.replace('_open', ''),\n      openNode: node,\n      closeNode: null,\n      children: []\n    };\n  }\n\n    // dummy root node\n  let rootNode = genTreeNode(null);\n  let curr = rootNode;\n  let stack = [];\n  tokens.forEach(function (tok, idx) {\n    let tmp;\n    if (tok.nesting === 1) {\n      tmp = genTreeNode(tok);\n      curr.children.push(tmp);\n      stack.push(curr);\n      curr = tmp;\n    } else if (tok.nesting === -1) {\n      curr.closeNode = tok;\n      if (!stack.length) throw new Error('AST stack underflow.');\n      tmp = stack.pop();\n            // TODO: check whether the close node corresponds to the one it opens\n            // curr = stack[stack.length - 1];\n      curr = tmp;\n    } else if (tok.nesting === 0) {\n      curr.children.push(tok);\n    } else {\n      throw new Error('Invalid nesting level found in token index ' + idx + '.');\n    }\n  });\n\n  if (stack.length !== 0) { throw new Error('Unbalanced block open/close tokens.'); }\n\n  return rootNode.children;\n}\n\nmodule.exports = {\n  makeAST: markdownItAST\n};\n"],"names":["markdownItAST","tokens","genTreeNode","node","nodeType","type","replace","openNode","closeNode","children","rootNode","curr","stack","forEach","tok","idx","tmp","nesting","push","length","Error","pop","module","exports","makeAST"],"mappings":"AAEA,SAASA,aAAT,CAAuBC,MAAvB,EAA+B;AAC7B,WAASC,WAAT,CAAqBC,IAArB,EAA2B;AACzB,WAAO;AACLC,MAAAA,QAAQ,EAAED,IAAI,IAAIA,IAAI,CAACE,IAAL,CAAUC,OAAV,CAAkB,OAAlB,EAA2B,EAA3B,CADb;AAELC,MAAAA,QAAQ,EAAEJ,IAFL;AAGLK,MAAAA,SAAS,EAAE,IAHN;AAILC,MAAAA,QAAQ,EAAE;AAJL,KAAP;AAMD,GAR4B;;;AAW7B,MAAIC,QAAQ,GAAGR,WAAW,CAAC,IAAD,CAA1B;AACA,MAAIS,IAAI,GAAGD,QAAX;AACA,MAAIE,KAAK,GAAG,EAAZ;AACAX,EAAAA,MAAM,CAACY,OAAP,CAAe,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AACjC,QAAIC,GAAJ;;AACA,QAAIF,GAAG,CAACG,OAAJ,KAAgB,CAApB,EAAuB;AACrBD,MAAAA,GAAG,GAAGd,WAAW,CAACY,GAAD,CAAjB;AACAH,MAAAA,IAAI,CAACF,QAAL,CAAcS,IAAd,CAAmBF,GAAnB;AACAJ,MAAAA,KAAK,CAACM,IAAN,CAAWP,IAAX;AACAA,MAAAA,IAAI,GAAGK,GAAP;AACD,KALD,MAKO,IAAIF,GAAG,CAACG,OAAJ,KAAgB,CAAC,CAArB,EAAwB;AAC7BN,MAAAA,IAAI,CAACH,SAAL,GAAiBM,GAAjB;AACA,UAAI,CAACF,KAAK,CAACO,MAAX,EAAmB,MAAM,IAAIC,KAAJ,CAAU,sBAAV,CAAN;AACnBJ,MAAAA,GAAG,GAAGJ,KAAK,CAACS,GAAN,EAAN,CAH6B;AAKvB;;AACNV,MAAAA,IAAI,GAAGK,GAAP;AACD,KAPM,MAOA,IAAIF,GAAG,CAACG,OAAJ,KAAgB,CAApB,EAAuB;AAC5BN,MAAAA,IAAI,CAACF,QAAL,CAAcS,IAAd,CAAmBJ,GAAnB;AACD,KAFM,MAEA;AACL,YAAM,IAAIM,KAAJ,CAAU,gDAAgDL,GAAhD,GAAsD,GAAhE,CAAN;AACD;AACF,GAnBD;;AAqBA,MAAIH,KAAK,CAACO,MAAN,KAAiB,CAArB,EAAwB;AAAE,UAAM,IAAIC,KAAJ,CAAU,qCAAV,CAAN;AAAyD;;AAEnF,SAAOV,QAAQ,CAACD,QAAhB;AACD;;AAEDa,MAAM,CAACC,OAAP,GAAiB;AACfC,EAAAA,OAAO,EAAExB;AADM,CAAjB"}